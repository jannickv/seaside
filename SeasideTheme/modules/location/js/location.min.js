/**
 * Interaction for the location module
 *
 * @author Tijs Verkoyen <tijs@sumocoders.be>
 */jsFrontend.location={map:{},directionService:null,directionsDisplay:null,init:function(){$(".parseMap").length>0&&$(".parseMap").each(function(){var e=$(this).attr("id").replace("map","");google.maps.event.addDomListener(window,"load",jsFrontend.location.initMap(e))})},initMap:function(e){var t=e==""?"":"_"+e,n=e==""?"general":e,r={zoom:jsFrontend.data.get("location.settings"+t+".zoom_level")=="auto"?0:parseInt(jsFrontend.data.get("location.settings"+t+".zoom_level")),center:new google.maps.LatLng(jsFrontend.data.get("location.settings"+t+".center.lat"),jsFrontend.data.get("location.settings"+t+".center.lng")),mapTypeId:google.maps.MapTypeId[jsFrontend.data.get("location.settings"+t+".map_type")]};jsFrontend.location.map[n]=new google.maps.Map(document.getElementById("map"+e),r);var i=jsFrontend.data.get("location.items"+t);if(i.length>0)for(var s in i)jsFrontend.location.addMarker(n,i[s].id,i[s].lat,i[s].lng,i[s].title);if(jsFrontend.data.get("location.settings"+t+".directions")){jsFrontend.location.directionsService==null&&(jsFrontend.location.directionsService=new google.maps.DirectionsService);jsFrontend.location.directionsDisplay==null&&(jsFrontend.location.directionsDisplay=new google.maps.DirectionsRenderer);$("#locationSearch"+e+" form").on("submit",function(t){t.preventDefault();jsFrontend.location.setRoute(e,n,i[0])})}},addMarker:function(e,t,n,r,i){var s=new google.maps.Marker({position:new google.maps.LatLng(n,r),map:jsFrontend.location.map[e],title:i,locationId:t});google.maps.event.addListener(s,"click",function(){$markerText=$("#markerText"+s.locationId);$markerText.length>0&&(text=$markerText.html());var t="<h1>"+i+"</h1>";typeof text!="undefined"&&(t+=text);(new google.maps.InfoWindow({content:t})).open(jsFrontend.location.map[e],s)})},setRoute:function(e,t,n){$error=$("#locationSearchError"+e);$search=$("#locationSearchAddress"+e);$search.val()==""?$error.show():$error.hide();var r=new google.maps.LatLng(n.lat,n.lng),i={origin:$search.val(),destination:r,travelMode:google.maps.DirectionsTravelMode.DRIVING};jsFrontend.location.directionsService.route(i,function(e,n){if(n==google.maps.DirectionsStatus.OK){jsFrontend.location.directionsDisplay.setMap(jsFrontend.location.map[t]);jsFrontend.location.directionsDisplay.setDirections(e)}else $error.show()})}};$(jsFrontend.location.init);